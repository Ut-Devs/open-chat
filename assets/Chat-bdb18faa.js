import{d as D,a as _,_ as m,c as o,b as v,e as s,t as p,n as u,o as t,p as z,f as O,w as y,g as n,r as i,h as k,i as L,j as w,k as S,F as j,l as B}from"./index-5cbe7ecf.js";import{C as $,a as P}from"./ContactsList-70f054af.js";function N(e){const r=new Date;return e.getDate()<r.getDate()?e.toLocaleDateString("pt-BR",{timeZone:"America/Sao_Paulo"}):e.toLocaleTimeString("pt-BR",{timeZone:"America/Sao_Paulo"}).replace(/(.*)\D\d+/,"$1")}const x=D("user",{state:()=>({sessionId:"",selectedContact:null}),actions:{setSessionId(e){this.sessionId=e}},getters:{getSessionId(){return this.sessionId}}}),V=_({name:"Messages",props:{message:{type:Object,required:!0}},setup(){return{userStore:x()}},mounted(){this.$refs.message.scrollIntoView({behavior:"smooth"})},computed:{isSender(){return this.message.sender===this.userStore.getSessionId},date(){return N(new Date(this.message.sendAt))}}});const M=e=>(z("data-v-af730bf0"),e=e(),O(),e),A={key:0,class:"message__wrapper__info"},H=M(()=>s("div",{class:"message__wrapper__info--image"},[s("img",{src:"https://picsum.photos/200",alt:"user image"})],-1)),E=M(()=>s("span",null,"Jhon Doe",-1)),F=[H,E],J={class:"message__wrapper--date"};function R(e,r,c,l,g,h){return t(),o("div",{class:u([{"message__wrapper--sender":e.isSender},{"message__wrapper--recipient":!e.isSender}]),ref:"message"},[e.isSender?v("",!0):(t(),o("div",A,F)),s("div",{class:u([{"message__wrapper--sender-content":e.isSender},{"message__wrapper--recipient-content":!e.isSender}])},[s("span",null,p(e.message.content),1)],2),s("span",J,p(e.date),1)],2)}const T=m(V,[["render",R],["__scopeId","data-v-af730bf0"]]),Z=_({name:"SendMessageInput",setup(){const e=$(),r=x();return{chatStore:e,userStore:r}},mounted(){const e=this.$refs.input;e.addEventListener("keypress",r=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),e.value&&this.sendMessage())})},methods:{sendMessage(){const e=this.$refs.input.value,r={id:Math.random().toString(36).slice(2,9),content:e,sendAt:new Date,recipient:"all",sender:this.userStore.getSessionId};this.$socket.emit("sendMessage",JSON.stringify(r));const c=this.$refs.input;c.value=""}}});const q={class:"wrapper"},K={rows:"1",ref:"input",placeholder:"type something...",class:"wrapper__input"},U=["hovered"];function W(e,r,c,l,g,h){const a=i("font-awesome-icon"),d=k("motion");return t(),o("div",q,[s("textarea",K,null,512),y((t(),o("button",{initial:{scale:1},hovered:{scale:1.1},enter:{scale:1},onClick:r[0]||(r[0]=(...f)=>e.sendMessage&&e.sendMessage(...f)),class:"wrapper__button"},[n(a,{icon:"fa-regular fa-paper-plane"})],8,U)),[[d]])])}const G=m(Z,[["render",W],["__scopeId","data-v-cd28316e"]]),Q=_({name:"ChatHeader",computed:{isMobile(){return window.innerWidth<768}}});const X={class:"header__wrapper"},Y={key:0,class:"header__wrapper--left"},ee={class:"header__wrapper--center"},se=s("div",{class:"header__wrapper--center__image"},[s("img",{lazy:"",src:"https://picsum.photos/200",alt:"user image"})],-1),re={class:"header__wrapper--center__info"},te=s("span",{class:"header__wrapper--center__info--name"},"John Doe",-1),ae={class:"header__wrapper--center__info--status"},ne={class:"header__wrapper--right"};function oe(e,r,c,l,g,h){const a=i("font-awesome-icon"),d=i("router-link");return t(),o("nav",X,[e.isMobile?(t(),o("div",Y,[n(d,{to:"contacts"},{default:L(()=>[n(a,{icon:"fa-solid fa-chevron-left"})]),_:1})])):v("",!0),s("div",ee,[se,s("div",re,[te,w(" "+p(" ")+" "),s("span",ae,[w("online "),n(a,{class:"header__wrapper--center__info--status--icon",icon:"fa-solid fa-circle"})])])]),s("div",ne,[n(a,{icon:"fa-solid fa-video"}),n(a,{icon:"fa-solid fa-phone-alt"}),n(a,{icon:"fa-solid fa-ellipsis-v"})])])}const ie=m(Q,[["render",oe]]),ce=_({components:{SendMessageInput:G,Message:T,ChatHeader:ie,ContactsList:P},setup(){const e=$(),r=x();return{chatStore:e,userStore:r}},sockets:{connect:function(){console.log("socket connected")},session:function(e){this.userStore.setSessionId(e.id),console.log("session",this.userStore.getSessionId)},messageReceived(e){console.log("message received",e),this.chatStore.sendMessage(e)}},computed:{messages(){return this.chatStore.getMessages},isMobile(){return screen.width<768},selectedContact(){return this.chatStore.getSelectedContact}}});const de={class:"chat"},pe={class:"chat__header"},_e={class:"chat__body"},me={class:"chat__form"};function le(e,r,c,l,g,h){const a=i("ContactsList"),d=i("ChatHeader"),f=i("Message"),C=i("SendMessageInput"),b=k("motion");return t(),o("div",{class:u(["view-container",{"view-container--desktop":!e.isMobile}])},[e.isMobile?v("",!0):(t(),S(a,{key:0})),s("div",de,[s("nav",pe,[y(n(d,{initial:{y:-100,opacity:0},enter:{y:0,opacity:1}},null,512),[[b]]),w(" "+p(e.selectedContact),1)]),s("section",_e,[(t(!0),o(j,null,B(e.messages,I=>y((t(),S(f,{initial:{scale:0,opacity:0},enter:{scale:1,opacity:1},message:I},null,8,["message"])),[[b]])),256))]),s("div",me,[n(C)])])],2)}const fe=m(ce,[["render",le]]);export{fe as default};
